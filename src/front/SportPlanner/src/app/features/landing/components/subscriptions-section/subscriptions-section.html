<!-- Subscriptions Section -->
<section class="py-20 bg-gray-50">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Section Header -->
    <div class="text-center max-w-3xl mx-auto mb-12" @fadeInUp>
      <div class="inline-flex items-center space-x-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-full text-sm font-semibold mb-4">
        <fa-icon [icon]="faCrown" [attr.aria-hidden]="true"></fa-icon>
        <span>Planes y Precios</span>
      </div>
      
      <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
        Elige el plan perfecto 
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600">
          para tu equipo
        </span>
      </h2>
      <p class="text-xl text-gray-600 mb-8">
        Desde entrenadores individuales hasta clubes completos.
        Sin costos ocultos, cancela cuando quieras.
      </p>
      
      <!-- Billing Toggle -->
      <div class="inline-flex items-center space-x-4 p-1 bg-white rounded-lg shadow-sm">
        <button
          type="button"
          (click)="billingPeriod.set('monthly')"
          class="px-4 py-2 rounded-md font-medium transition-colors"
          [class.bg-blue-600]="billingPeriod() === 'monthly'"
          [class.text-white]="billingPeriod() === 'monthly'"
          [class.text-gray-700]="billingPeriod() !== 'monthly'">
          Mensual
        </button>
        <button
          type="button"
          (click)="billingPeriod.set('annual')"
          class="px-4 py-2 rounded-md font-medium transition-colors relative"
          [class.bg-blue-600]="billingPeriod() === 'annual'"
          [class.text-white]="billingPeriod() === 'annual'"
          [class.text-gray-700]="billingPeriod() !== 'annual'">
          Anual
          <span class="absolute -top-2 -right-2 px-1 py-0.5 bg-green-500 text-white text-xs font-bold rounded">
            -20%
          </span>
        </button>
      </div>
    </div>
    
    <!-- Plans Grid -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
      @for (plan of plans; track plan.id) {
        <div 
          class="relative bg-white rounded-2xl border-2 p-6 transition-all duration-300 hover:scale-105"
          [class]="getPlanColorClasses(plan.color, plan.isPopular)"
          @scaleIn>
          
          <!-- Popular Badge -->
          @if (plan.isPopular) {
            <div class="absolute -top-4 left-1/2 transform -translate-x-1/2" @pulse>
              <div class="px-4 py-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-sm font-bold rounded-full shadow-lg">
                ⭐ MÁS POPULAR
              </div>
            </div>
          }
          
          <!-- Plan Header -->
          <div class="text-center mb-6">
            <div class="w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center"
                 [class.bg-gray-100]="plan.color === 'gray'"
                 [class.bg-blue-100]="plan.color === 'blue'"
                 [class.bg-purple-100]="plan.color === 'purple'">
              <fa-icon 
                [icon]="plan.icon" 
                class="text-2xl"
                [class.text-gray-600]="plan.color === 'gray'"
                [class.text-blue-600]="plan.color === 'blue'"
                [class.text-purple-600]="plan.color === 'purple'"
                [attr.aria-hidden]="true"></fa-icon>
            </div>
            
            <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ plan.name }}</h3>
            <p class="text-gray-600 text-sm mb-4">{{ plan.description }}</p>
            
            <!-- Price -->
            <div class="mb-4">
              <span class="text-4xl font-bold text-gray-900">{{ getPrice(plan) }}{{ plan.currency }}</span>
              <span class="text-gray-600">{{ getPeriodText() }}</span>
            </div>
            
            <!-- Quick Stats -->
            @if (plan.maxTeams) {
              <div class="flex justify-center space-x-4 text-sm text-gray-600 mb-4">
                @if (plan.maxTeams && plan.maxTeams !== Infinity) {
                  <span class="flex items-center space-x-1">
                    <fa-icon [icon]="faUsers" [attr.aria-hidden]="true"></fa-icon>
                    <span>{{ plan.maxTeams }} equipo(s)</span>
                  </span>
                }
                @if (plan.maxTrainings && plan.maxTrainings !== Infinity) {
                  <span class="flex items-center space-x-1">
                    <fa-icon [icon]="faChartLine" [attr.aria-hidden]="true"></fa-icon>
                    <span>{{ plan.maxTrainings }} entrenamientos</span>
                  </span>
                }
              </div>
            }
          </div>
          
          <!-- Features List -->
          <ul class="space-y-3 mb-6">
            @for (feature of plan.features; track feature.text) {
              <li class="flex items-start space-x-2">
                <fa-icon 
                  [icon]="feature.included ? faCheck : faTimes" 
                  class="mt-0.5 flex-shrink-0"
                  [class.text-green-500]="feature.included"
                  [class.text-gray-300]="!feature.included"
                  [attr.aria-hidden]="true"></fa-icon>
                <span 
                  class="text-sm"
                  [class.text-gray-700]="feature.included"
                  [class.text-gray-400]="!feature.included"
                  [class.line-through]="!feature.included">
                  {{ feature.text }}
                  @if (feature.text.includes('ilimitad')) {
                    <fa-icon 
                      [icon]="faInfinity" 
                      class="inline ml-1 text-xs"
                      [attr.aria-hidden]="true"></fa-icon>
                  }
                </span>
              </li>
            }
          </ul>
          
          <!-- CTA Button -->
          <a 
            routerLink="/register"
            [queryParams]="{plan: plan.id}"
            class="block w-full py-3 px-4 text-center text-white font-semibold rounded-lg transition-colors shadow-md"
            [class]="getButtonColorClasses(plan.color)">
            @if (plan.price === 0) {
              Empezar Gratis
            } @else {
              Elegir {{ plan.name }}
            }
          </a>
        </div>
      }
    </div>
    
    <!-- Additional Features -->
    <div class="bg-white rounded-2xl p-8 border border-gray-200">
      <h3 class="text-xl font-semibold text-gray-900 text-center mb-6">
        Incluido en todos los planes
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        @for (feature of additionalFeatures; track feature.text) {
          <div class="flex items-center space-x-3">
            <div class="p-2 bg-blue-100 rounded-lg">
              <fa-icon 
                [icon]="feature.icon" 
                class="text-blue-600"
                [attr.aria-hidden]="true"></fa-icon>
            </div>
            <span class="text-gray-700">{{ feature.text }}</span>
          </div>
        }
      </div>
    </div>
    
    <!-- FAQ Link -->
    <div class="text-center mt-12">
      <p class="text-gray-600 mb-4">
        ¿Tienes preguntas? Consulta nuestras 
        <a href="#" class="text-blue-600 hover:text-blue-700 font-medium underline">
          preguntas frecuentes
        </a>
        o 
        <a href="#" class="text-blue-600 hover:text-blue-700 font-medium underline">
          contáctanos
        </a>
      </p>
      <div class="flex items-center justify-center space-x-2 text-sm text-gray-500">
        <fa-icon [icon]="faShieldAlt" [attr.aria-hidden]="true"></fa-icon>
        <span>Garantía de devolución de 30 días • Sin permanencia • Cancela cuando quieras</span>
      </div>
    </div>
  </div>
</section>
